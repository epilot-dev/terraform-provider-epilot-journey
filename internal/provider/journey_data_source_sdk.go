// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package provider

import (
	"context"
	"encoding/json"
	tfTypes "github.com/epilot-dev/terraform-provider-epilot-journey/internal/provider/types"
	"github.com/epilot-dev/terraform-provider-epilot-journey/internal/sdk/models/operations"
	"github.com/epilot-dev/terraform-provider-epilot-journey/internal/sdk/models/shared"
	"github.com/hashicorp/terraform-plugin-framework-jsontypes/jsontypes"
	"github.com/hashicorp/terraform-plugin-framework/diag"
	"github.com/hashicorp/terraform-plugin-framework/types"
)

func (r *JourneyDataSourceModel) RefreshFromSharedJourneyCreationRequestV2(ctx context.Context, resp *shared.JourneyCreationRequestV2) diag.Diagnostics {
	var diags diag.Diagnostics

	if resp != nil {
		r.Manifest = make([]types.String, 0, len(resp.Manifest))
		for _, v := range resp.Manifest {
			r.Manifest = append(r.Manifest, types.StringValue(v))
		}
		r.BrandID = types.StringPointerValue(resp.BrandID)
		r.ContextSchema = []tfTypes.JourneyCreationRequestV2ContextSchema{}

		for _, contextSchemaItem := range resp.ContextSchema {
			var contextSchema tfTypes.JourneyCreationRequestV2ContextSchema

			contextSchema.IsRequired = types.BoolPointerValue(contextSchemaItem.IsRequired)
			contextSchema.ParamKey = types.StringValue(contextSchemaItem.ParamKey)
			contextSchema.ShouldLoadEntity = types.BoolPointerValue(contextSchemaItem.ShouldLoadEntity)
			contextSchema.Type = types.StringValue(contextSchemaItem.Type)

			r.ContextSchema = append(r.ContextSchema, contextSchema)
		}
		if resp.Design == nil {
			r.Design = nil
		} else {
			r.Design = &tfTypes.JourneyCreationRequestV2Design{}
			if resp.Design.DesignTokens == nil {
				r.Design.DesignTokens = nil
			} else {
				r.Design.DesignTokens = &tfTypes.JourneyCreationRequestV2DesignTokens{}
			}
			r.Design.LogoURL = types.StringPointerValue(resp.Design.LogoURL)
			if len(resp.Design.Theme) > 0 {
				r.Design.Theme = make(map[string]jsontypes.Normalized, len(resp.Design.Theme))
				for key, value := range resp.Design.Theme {
					result, _ := json.Marshal(value)
					r.Design.Theme[key] = jsontypes.NewNormalizedValue(string(result))
				}
			}
		}
		r.JourneyType = types.StringPointerValue(resp.JourneyType)
		r.JourneyID = types.StringPointerValue(resp.JourneyID)
		if resp.Logics == nil {
			r.Logics = jsontypes.NewNormalizedNull()
		} else {
			logicsResult, _ := json.Marshal(resp.Logics)
			r.Logics = jsontypes.NewNormalizedValue(string(logicsResult))
		}
		r.Name = types.StringValue(resp.Name)
		r.Rules = []tfTypes.JourneyCreationRequestV2Rules{}

		for _, rulesItem := range resp.Rules {
			var rules tfTypes.JourneyCreationRequestV2Rules

			rules.Source = types.StringValue(rulesItem.Source)
			rules.SourceType = types.StringValue(string(rulesItem.SourceType))
			rules.Target = types.StringValue(rulesItem.Target)
			rules.Type = types.StringValue(string(rulesItem.Type))

			r.Rules = append(r.Rules, rules)
		}
		if resp.Settings == nil {
			r.Settings = nil
		} else {
			r.Settings = &tfTypes.JourneyCreationRequestV2Settings{}
			if resp.Settings.AccessMode != nil {
				r.Settings.AccessMode = types.StringValue(string(*resp.Settings.AccessMode))
			} else {
				r.Settings.AccessMode = types.StringNull()
			}
			r.Settings.AddressSuggestionsFileID = types.StringPointerValue(resp.Settings.AddressSuggestionsFileID)
			r.Settings.AddressSuggestionsFileURL = types.StringPointerValue(resp.Settings.AddressSuggestionsFileURL)
			r.Settings.Description = types.StringPointerValue(resp.Settings.Description)
			r.Settings.DesignID = types.StringPointerValue(resp.Settings.DesignID)
			if resp.Settings.EmbedOptions == nil {
				r.Settings.EmbedOptions = nil
			} else {
				r.Settings.EmbedOptions = &tfTypes.JourneyCreationRequestV2EmbedOptions{}
				if resp.Settings.EmbedOptions.Button == nil {
					r.Settings.EmbedOptions.Button = nil
				} else {
					r.Settings.EmbedOptions.Button = &tfTypes.JourneyCreationRequestV2Button{}
					if resp.Settings.EmbedOptions.Button.Align != nil {
						r.Settings.EmbedOptions.Button.Align = types.StringValue(string(*resp.Settings.EmbedOptions.Button.Align))
					} else {
						r.Settings.EmbedOptions.Button.Align = types.StringNull()
					}
					r.Settings.EmbedOptions.Button.Text = types.StringPointerValue(resp.Settings.EmbedOptions.Button.Text)
				}
				if resp.Settings.EmbedOptions.Lang != nil {
					r.Settings.EmbedOptions.Lang = types.StringValue(string(*resp.Settings.EmbedOptions.Lang))
				} else {
					r.Settings.EmbedOptions.Lang = types.StringNull()
				}
				if resp.Settings.EmbedOptions.Mode != nil {
					r.Settings.EmbedOptions.Mode = types.StringValue(string(*resp.Settings.EmbedOptions.Mode))
				} else {
					r.Settings.EmbedOptions.Mode = types.StringNull()
				}
				r.Settings.EmbedOptions.ScrollToTop = types.BoolPointerValue(resp.Settings.EmbedOptions.ScrollToTop)
				r.Settings.EmbedOptions.TopBar = types.BoolPointerValue(resp.Settings.EmbedOptions.TopBar)
				r.Settings.EmbedOptions.Width = types.StringPointerValue(resp.Settings.EmbedOptions.Width)
			}
			r.Settings.EnableDarkMode = types.BoolPointerValue(resp.Settings.EnableDarkMode)
			r.Settings.EntityID = types.StringPointerValue(resp.Settings.EntityID)
			r.Settings.EntityTags = make([]types.String, 0, len(resp.Settings.EntityTags))
			for _, v := range resp.Settings.EntityTags {
				r.Settings.EntityTags = append(r.Settings.EntityTags, types.StringValue(v))
			}
			r.Settings.FilePurposes = make([]types.String, 0, len(resp.Settings.FilePurposes))
			for _, v := range resp.Settings.FilePurposes {
				r.Settings.FilePurposes = append(r.Settings.FilePurposes, types.StringValue(v))
			}
			r.Settings.MappingsAutomationID = types.StringPointerValue(resp.Settings.MappingsAutomationID)
			r.Settings.PublicToken = types.StringPointerValue(resp.Settings.PublicToken)
			r.Settings.RuntimeEntities = make([]types.String, 0, len(resp.Settings.RuntimeEntities))
			for _, v := range resp.Settings.RuntimeEntities {
				r.Settings.RuntimeEntities = append(r.Settings.RuntimeEntities, types.StringValue(string(v)))
			}
			r.Settings.SafeModeAutomation = types.BoolPointerValue(resp.Settings.SafeModeAutomation)
			r.Settings.TargetedCustomer = types.StringPointerValue(resp.Settings.TargetedCustomer)
			r.Settings.TemplateID = types.StringPointerValue(resp.Settings.TemplateID)
			r.Settings.ThirdPartyCookies = types.BoolPointerValue(resp.Settings.ThirdPartyCookies)
			r.Settings.UseNewDesign = types.BoolPointerValue(resp.Settings.UseNewDesign)
		}
		stepsResult, _ := json.Marshal(resp.Steps)
		r.Steps = jsontypes.NewNormalizedValue(string(stepsResult))
	}

	return diags
}

func (r *JourneyDataSourceModel) ToOperationsGetJourneyV2Request(ctx context.Context) (*operations.GetJourneyV2Request, diag.Diagnostics) {
	var diags diag.Diagnostics

	var id string
	id = r.JourneyID.ValueString()

	out := operations.GetJourneyV2Request{
		ID: id,
	}

	return &out, diags
}
